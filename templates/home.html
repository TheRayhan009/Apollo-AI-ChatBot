<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <link rel="icon" type="image/jpg" href="/staticfiles/admin/img/logo.jpg">
  <title>
   Chatbot
  </title>
  <script src="https://cdn.tailwindcss.com">
  </script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
 
  <style>
    @keyframes thinking {
             0% { opacity: 0.2; }
             50% { opacity: 1; }
             100% { opacity: 0.2; }
         }
         .thinking {
             animation: thinking 1s infinite;
         }
        
   </style>


</head>
 <body class="bg-gray-100 font-sans">
  <div class="flex h-screen">
   <!-- Sidebar -->
   <div class="w-1/4 bg-gray-900 text-white flex flex-col">
    <div class="p-4 flex items-center">
     <i class="fas fa-robot text-2xl mr-2">
     </i>
     <div>
      <h1 class="text-lg font-bold">
       APOLLO
      </h1>
      <p class="text-sm">
       by TheRayhan
      </p>
     </div>
    </div>
    <button class="bg-blue-500 text-white py-2 px-4 rounded-lg mx-4 my-2" onclick="newTab()">
     New Chat
    </button>
    <div class="px-4 mt-4">
     <h2 class="text-lg font-bold text-yellow-400">
      Terms and Conditions
     </h2>
     <p class="text-gray-400 mt-2">
      It's a temporary chat for privacy reasons.
      <span class="text-red-500">
       Be careful. Do not refresh your browser tab.
      </span>
     </p>
     <p class="text-green-500 mt-2">
      All conversations are not saved. Once you leave, the chat history will be lost.
     </p>
     <p class="text-gray-400 mt-2">
      Do not share any personal or sensitive information in the chat.
     </p>
    </div>
    <div class="flex-1">
    </div>
    <div class="p-4 bg-gray-800">
     <button class="bg-green-500 text-white py-2 px-4 rounded-lg w-full">
      Upgrade Premium
     </button>
     <p class="text-xs text-gray-400 mt-2">
      Better speed, more research
     </p>
    </div>
   </div>
   <!-- Main Content -->
   <div class="flex-1 flex flex-col p-8" >
    <div class="flex-1 overflow-y-auto">
     <div class="text-center mb-8">
      <i class="fas fa-robot text-5xl mb-4">
      </i>
      <h1 class="text-2xl font-bold mb-2">
       Welcome to the APOLLO
      </h1>
      <p class="text-gray-600 mb-8">
       Your Personal AI Companion
      </p>
      <div class="flex space-x-4">
       <div class="bg-white p-4 rounded-lg shadow-md w-1/3">
        <i class="fas fa-book-open text-xl mb-2">
        </i>
        <h2 class="font-semibold">
         Explore various subjects
        </h2>
        <p class="text-gray-600 mt-2">
         "Can you provide an overview of the latest advancements in artificial intelligence?"
        </p>
       </div>
       <div class="bg-white p-4 rounded-lg shadow-md w-1/3">
        <i class="fas fa-search text-xl mb-2">
        </i>
        <h2 class="font-semibold">
         Find your answers
        </h2>
        <p class="text-gray-600 mt-2">
         "What are some effective strategies for improving productivity and time management?"
        </p>
       </div>
       <div class="bg-white p-4 rounded-lg shadow-md w-1/3">
        <i class="fas fa-cogs text-xl mb-2">
        </i>
        <h2 class="font-semibold">
         Choose your preference
        </h2>
        <p class="text-gray-600 mt-2">
         "How can I enhance my skills in office management department?"
        </p>
       </div>
      </div>
     </div>
     <!-- Chat Messages -->
     <div class="space-y-4" id="chatBox">
        
        
     </div>
     <div class="flex items-start" id="think">
        
       </div>
    </div>
    <div class="mt-auto w-full flex items-center p-4">
     <input class="flex-1 p-4 rounded-l-lg border border-gray-300" placeholder="Ask me anything..." type="text" id="userprompt"/>
     <button class="bg-blue-500 text-white p-4 rounded-r-lg" onclick="test()">
      <i class="fas fa-paper-plane" >
      </i>
     </button>
    </div>
   </div>
  </div>
  {% load static %}
  <script>
    let ren=0;
    function test(){
      console.log("hello");
  
      let data = $("#userprompt").val();
      if(data !== ""){
          console.log(data);
  
          document.getElementById("chatBox").insertAdjacentHTML("beforeend", `
              <div class="flex items-start justify-end">
                  <div class="bg-blue-500 text-white p-4 rounded-lg">
                      <p>${data}</p>
                  </div>
                  <img alt="User avatar image" class="w-10 h-10 rounded-full ml-4" 
                      height="50" 
                      src="https://storage.googleapis.com/a1aa/image/1_LnEf5K6WfBVU73C8tjcyrMz01_wlqmtQ0k-t2wvtQ.jpg" 
                      width="50"/>
              </div>
          `);
          
          
          document.getElementById("think").insertAdjacentHTML("beforeend", `
              <img alt="Bot avatar image" class="w-10 h-10 rounded-full mr-4" height="50" src="https://storage.googleapis.com/a1aa/image/0LS9r2t2Iw_S4qExkh4IajU6z25uVyr3ciFQsgbjs1Y.jpg" width="50"/>
          <div class="bg-gray-200 p-4 rounded-lg flex items-center">
           <div class="thinking w-2 h-2 bg-gray-500 rounded-full mr-1">
           </div>
           <div class="thinking w-2 h-2 bg-gray-500 rounded-full mr-1">
           </div>
           <div class="thinking w-2 h-2 bg-gray-500 rounded-full">
           </div>
          </div>
          `);
  
          $.ajax({
              method:"GET",
              url:"/getbotreply/",
              data:{
                  "prompt":data
              }
          }).done(function(response){
              let data=JSON.parse(response)
              console.log("done");
              console.log(data.reply);

              document.getElementById("chatBox").insertAdjacentHTML("beforeend", `
                  <div class="flex items-start" id="bot">
                      <img alt="Bot avatar image" class="w-10 h-10 rounded-full mr-4" height="50" 
                           src="https://storage.googleapis.com/a1aa/image/0LS9r2t2Iw_S4qExkh4IajU6z25uVyr3ciFQsgbjs1Y.jpg" width="50"/>
                      <div class="bg-gray-200 p-4 rounded-lg" style="max-width: 800px; overflow-x: auto;">
                          <pre style="max-width: 800px; class="bg-gray-100 p-2 rounded-lg overflow-x-auto"><code class="language-python" id="txtBot${ren}"></code></pre>
                      </div>
                  </div>
              `);
                
              document.getElementById("think").innerHTML = "";
              $("#txtBot").val()
              typeWriterEffect(data.reply,`#txtBot${ren}`);
              scrollToBottom()
  
  
          })
          
          $("#userprompt").val("");
      }
  
  }
  
  function newTab(){
      location.reload();
  }
  
  function scrollToBottom() {
      $("#chatBox").stop().animate({ scrollTop: $("#chatBox")[0].scrollHeight }, 500);
  
  }
  
  function typeWriterEffect(text, elementSelector) {
    ren+=1;
    let i = 0;
    let r = "";
    console.log("done");
    function type() {
      console.log("done");
      if (i < text.length) {
        r += text.charAt(i);
        $(elementSelector).text(r); 
        i++;
        setTimeout(type, 30); 
      }
    }
    
    type();
  }
  

  </script>
  
 </body>
</html>

